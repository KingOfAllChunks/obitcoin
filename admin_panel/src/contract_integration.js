class contract_integration{

	constructor(){
		this.accounts = [];
		this.account = "";

		this.contractAbi = [{"constant":true,"inputs":[{"name":"pool","type":"uint16"}],"name":"getMembersBalance","outputs":[{"name":"","type":"uint128[2][]"},{"name":"","type":"uint16[]"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"pool","type":"uint16"}],"name":"getPoolData","outputs":[{"name":"","type":"bytes16[3]"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"getContractAddress","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"member","type":"uint16"}],"name":"getMemberDetails","outputs":[{"name":"","type":"bytes32"},{"name":"","type":"address"},{"name":"","type":"uint8"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"getPublishingBlockNumber","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"member","type":"uint16"},{"name":"name","type":"bytes32"},{"name":"adr","type":"address"},{"name":"isAdmin","type":"bool"}],"name":"updateMember","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint16"},{"name":"admin","type":"bool"}],"name":"setAdmin","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"getPools","outputs":[{"name":"","type":"uint16[]"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"pool","type":"uint16"}],"name":"getPoolParticipants","outputs":[{"name":"","type":"uint16[]"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"pool","type":"uint16"},{"name":"member","type":"uint16"},{"name":"amount","type":"uint128"}],"name":"sendCoins","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"getPoolCount","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"getMembers","outputs":[{"name":"","type":"uint16[]"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"name","type":"bytes16"},{"name":"legalContract","type":"bytes16"},{"name":"financialReports","type":"bytes16"}],"name":"createDebtPool","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"pool","type":"uint16"},{"name":"member","type":"uint16"}],"name":"getMemberBalance","outputs":[{"name":"","type":"uint128[2]"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"pool","type":"uint16"},{"name":"amount","type":"uint128"}],"name":"buyCoins","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"pool","type":"uint16"},{"name":"name","type":"bytes16"},{"name":"legalContract","type":"bytes16"},{"name":"financialReports","type":"bytes16"}],"name":"updateDebtPool","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"name","type":"bytes32"},{"name":"adr","type":"address"},{"name":"isAdmin","type":"bool"}],"name":"addMember","outputs":[],"payable":false,"type":"function"},{"inputs":[],"payable":false,"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"uint16"},{"indexed":true,"name":"to","type":"uint16"},{"indexed":true,"name":"pool","type":"uint16"},{"indexed":false,"name":"amount","type":"int256"},{"indexed":false,"name":"time","type":"uint256"}],"name":"TokenTransfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"uint16"},{"indexed":true,"name":"to","type":"uint16"},{"indexed":true,"name":"pool","type":"uint16"},{"indexed":false,"name":"amount","type":"uint128"},{"indexed":false,"name":"time","type":"uint256"}],"name":"SliceTransfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"uint16"},{"indexed":true,"name":"pool","type":"uint16"},{"indexed":false,"name":"amount","type":"uint128"},{"indexed":false,"name":"time","type":"uint256"}],"name":"TokenPurchase","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"uint16"},{"indexed":true,"name":"pool","type":"uint16"},{"indexed":false,"name":"added","type":"bool"},{"indexed":false,"name":"time","type":"uint256"}],"name":"PoolChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"uint16"},{"indexed":true,"name":"fromAddress","type":"address"},{"indexed":false,"name":"time","type":"uint256"}],"name":"UnauthorizedAccess","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"uint16"},{"indexed":true,"name":"to","type":"uint16"},{"indexed":false,"name":"added","type":"bool"},{"indexed":false,"name":"time","type":"uint256"}],"name":"AdminChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"uint16"},{"indexed":true,"name":"to","type":"uint16"},{"indexed":false,"name":"added","type":"bool"},{"indexed":false,"name":"time","type":"uint256"}],"name":"PersonChanged","type":"event"}];

		this.contractCompiled = '606060405234156200000d57fe5b5b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555043600660046101000a81548163ffffffff021916908363ffffffff1602179055506001600660006101000a81548161ffff021916908361ffff1602179055506001600660026101000a81548161ffff021916908361ffff1602179055506080604051908101604052807f4f776e65720000000000000000000000000000000000000000000000000000006000191681526020013373ffffffffffffffffffffffffffffffffffffffff168152602001600360038111156200010c57fe5b81526020016001151581525060016000600660009054906101000a900461ffff1661ffff1661ffff1681526020019081526020016000206000820151816000019060001916905560208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060408201518160010160146101000a81548160ff02191690836003811115620001bf57fe5b021790555060608201518160010160156101000a81548160ff02191690831515021790555090505060028054806001018281620001fd9190620002e9565b91600052602060002090601091828204019190066002025b600660009054906101000a900461ffff16909190916101000a81548161ffff021916908361ffff16021790555050600660009054906101000a900461ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548161ffff021916908361ffff1602179055506006600081819054906101000a900461ffff168092919060010191906101000a81548161ffff021916908361ffff160217905550505b6200034e565b8154818355818115116200032157600f016010900481600f0160109004836000526020600020918201910162000320919062000326565b5b505050565b6200034b91905b80821115620003475760008160009055506001016200032d565b5090565b90565b613edb806200035e6000396000f300606060405236156100ef576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806304a385e5146100f157806305790c08146101f157806332a2c5d01461025f57806338c5e15a146102b1578063438a5f131461033957806357091c811461036b5780635fd42e4d146103c6578063673a2a1f146103f55780636d8171301461046a5780637c62fc0d146104f15780638eec5d701461053d5780639eab525314610563578063a5f97554146105d8578063a97bd3fe14610643578063bf5c8235146106be578063cee11e96146106fd578063e1669f1714610775575bfe5b34156100f957fe5b610113600480803561ffff169060200190919050506107c3565b6040518080602001806020018381038352858181518152602001915080516000925b8184101561018e5782849060200190602002015160026020028083836000831461017e575b80518252602083111561017e5760208201915060208101905060208303925061015a565b5050509050019260010192610135565b925050508381038252848181518152602001915080519060200190602002808383600083146101dc575b8051825260208311156101dc576020820191506020810190506020830392506101b8565b50505090500194505050505060405180910390f35b34156101f957fe5b610213600480803561ffff16906020019091905050610a8a565b604051808260036020028083836000831461024d575b80518252602083111561024d57602082019150602081019050602083039250610229565b50505090500191505060405180910390f35b341561026757fe5b61026f610c10565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156102b957fe5b6102d3600480803561ffff16906020019091905050610c19565b6040518084600019166000191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182600381111561032357fe5b60ff168152602001935050505060405180910390f35b341561034157fe5b610349610cee565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b341561037357fe5b6103c4600480803561ffff169060200190919080356000191690602001909190803573ffffffffffffffffffffffffffffffffffffffff169060200190919080351515906020019091905050610d09565b005b34156103ce57fe5b6103f3600480803561ffff1690602001909190803515159060200190919050506111cb565b005b34156103fd57fe5b61040561147b565b6040518080602001828103825283818151815260200191508051906020019060200280838360008314610457575b80518252602083111561045757602082019150602081019050602083039250610433565b5050509050019250505060405180910390f35b341561047257fe5b61048c600480803561ffff16906020019091905050611502565b60405180806020018281038252838181518152602001915080519060200190602002808383600083146104de575b8051825260208311156104de576020820191506020810190506020830392506104ba565b5050509050019250505060405180910390f35b34156104f957fe5b61053b600480803561ffff1690602001909190803561ffff169060200190919080356fffffffffffffffffffffffffffffffff169060200190919050506115de565b005b341561054557fe5b61054d611c1f565b6040518082815260200191505060405180910390f35b341561056b57fe5b610573611c2d565b60405180806020018281038252838181518152602001915080519060200190602002808383600083146105c5575b8051825260208311156105c5576020820191506020810190506020830392506105a1565b5050509050019250505060405180910390f35b34156105e057fe5b61064160048080356fffffffffffffffffffffffffffffffff19169060200190919080356fffffffffffffffffffffffffffffffff19169060200190919080356fffffffffffffffffffffffffffffffff1916906020019091905050611cb4565b005b341561064b57fe5b610672600480803561ffff1690602001909190803561ffff169060200190919050506120ce565b60405180826002602002808383600083146106ac575b8051825260208311156106ac57602082019150602081019050602083039250610688565b50505090500191505060405180910390f35b34156106c657fe5b6106fb600480803561ffff169060200190919080356fffffffffffffffffffffffffffffffff16906020019091905050612201565b005b341561070557fe5b610773600480803561ffff169060200190919080356fffffffffffffffffffffffffffffffff19169060200190919080356fffffffffffffffffffffffffffffffff19169060200190919080356fffffffffffffffffffffffffffffffff19169060200190919050506134fb565b005b341561077d57fe5b6107c160048080356000191690602001909190803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803515159060200190919050506138af565b005b6107cb613d79565b6107d3613d8d565b6107db613d79565b6000600360008661ffff1661ffff16815260200190815260200160002060040160009054906101000a900460ff16151561081457610000565b600360008661ffff1661ffff168152602001908152602001600020600201805490506040518059106108435750595b90808252806020026020018201604052801561087957816020015b610866613da1565b81526020019060019003908161085e5790505b509150600090505b600360008661ffff1661ffff168152602001908152602001600020600201805490508161ffff1610156109e557600360008661ffff1661ffff1681526020019081526020016000206003016000600360008861ffff1661ffff1681526020019081526020016000206002018361ffff168154811015156108fd57fe5b90600052602060002090601091828204019190066002025b9054906101000a900461ffff1661ffff1661ffff1681526020019081526020016000206002806020026040519081016040528092919082600280156109b3576020028201916000905b82829054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020019060100190602082600f0104928301926001038202915080841161095e5790505b5050505050828261ffff168151811015156109ca57fe5b906020019060200201819052505b8080600101915050610881565b81600360008761ffff1661ffff16815260200190815260200160002060020180805480602002602001604051908101604052809291908181526020018280548015610a7757602002820191906000526020600020906000905b82829054906101000a900461ffff1661ffff1681526020019060020190602082600101049283019260010382029150808411610a3e5790505b50505050509050935093505b5050915091565b610a92613ddb565b600360008361ffff1661ffff16815260200190815260200160002060040160009054906101000a900460ff161515610ac957610000565b606060405190810160405280600360008561ffff1661ffff16815260200190815260200160002060000160009054906101000a9004700100000000000000000000000000000000026fffffffffffffffffffffffffffffffff19166fffffffffffffffffffffffffffffffff19168152602001600360008561ffff1661ffff16815260200190815260200160002060000160109054906101000a9004700100000000000000000000000000000000026fffffffffffffffffffffffffffffffff19166fffffffffffffffffffffffffffffffff19168152602001600360008561ffff1661ffff16815260200190815260200160002060010160009054906101000a9004700100000000000000000000000000000000026fffffffffffffffffffffffffffffffff19166fffffffffffffffffffffffffffffffff191681525090505b919050565b60003090505b90565b600060006000600160008561ffff1661ffff16815260200190815260200160002060010160159054906101000a900460ff161515610c5657610000565b600160008561ffff1661ffff16815260200190815260200160002060000154600160008661ffff1661ffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600160008761ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff169250925092505b9193909250565b6000600660049054906101000a900463ffffffff1690505b90565b60026003811115610d1657fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff166003811115610d9a57fe5b1480610e34575060036003811115610dae57fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff166003811115610e3257fe5b145b1561112457600160008561ffff1661ffff16815260200190815260200160002060010160159054906101000a900460ff161515610e7057610000565b60036003811115610e7d57fe5b600160008661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff166003811115610eb457fe5b1415610ebf57610000565b600060056000600160008861ffff1661ffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548161ffff021916908361ffff16021790555083600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548161ffff021916908361ffff16021790555082600160008661ffff1661ffff168152602001908152602001600020600001816000191690555081600160008661ffff1661ffff16815260200190815260200160002060010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080611042576001611045565b60025b600160008661ffff1661ffff16815260200190815260200160002060010160146101000a81548160ff0219169083600381111561107e57fe5b02179055508361ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f7107c2ae9754688147920c7dbf25c81ed808624042d38439123c6da5fe34beb460004260405180831515151581526020018281526020019250505060405180910390a35b6111c5565b3373ffffffffffffffffffffffffffffffffffffffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f08a520c83f3f94e52d4d4b14319f76c4924f0b58aa571d1d8956acc5849651ea426040518082815260200191505060405180910390a35b50505050565b600360038111156111d857fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff16600381111561125c57fe5b141515611308573373ffffffffffffffffffffffffffffffffffffffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f08a520c83f3f94e52d4d4b14319f76c4924f0b58aa571d1d8956acc5849651ea426040518082815260200191505060405180910390a3611477565b600160008361ffff1661ffff16815260200190815260200160002060010160159054906101000a900460ff16151561133f57610000565b6003600381111561134c57fe5b600160008461ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff16600381111561138357fe5b141561138e57610000565b8061139a57600161139d565b60025b600160008461ffff1661ffff16815260200190815260200160002060010160146101000a81548160ff021916908360038111156113d657fe5b02179055508161ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f955f9cd413b1613b572ff1877b25ae515763d2a51d926bd21ba78d8ec4f16c3c834260405180831515151581526020018281526020019250505060405180910390a35b5b5050565b611483613d8d565b60048054806020026020016040519081016040528092919081815260200182805480156114f757602002820191906000526020600020906000905b82829054906101000a900461ffff1661ffff16815260200190600201906020826001010492830192600103820291508084116114be5790505b505050505090505b90565b61150a613d8d565b600360008361ffff1661ffff16815260200190815260200160002060040160009054906101000a900460ff16151561154157610000565b600360008361ffff1661ffff1681526020019081526020016000206002018054806020026020016040519081016040528092919081815260200182805480156115d157602002820191906000526020600020906000905b82829054906101000a900461ffff1661ffff16815260200190600201906020826001010492830192600103820291508084116115985790505b505050505090505b919050565b600260038111156115eb57fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff16600381111561166f57fe5b148061170957506003600381111561168357fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff16600381111561170757fe5b145b15611b79576000816fffffffffffffffffffffffffffffffff1614806117585750600360008461ffff1661ffff16815260200190815260200160002060040160009054906101000a900460ff16155b8061178c5750600160008361ffff1661ffff16815260200190815260200160002060010160159054906101000a900460ff16155b1561179657610000565b600360008461ffff1661ffff16815260200190815260200160002060030160008361ffff1661ffff16815260200190815260200160002060006002811015156117db57fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681600360008661ffff1661ffff16815260200190815260200160002060030160008561ffff1661ffff168152602001908152602001600020600060028110151561185c57fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff16016fffffffffffffffffffffffffffffffff1610156118a357610000565b6000600360008561ffff1661ffff16815260200190815260200160002060030160008461ffff1661ffff16815260200190815260200160002060006002811015156118ea57fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff161480156119b157506000600360008561ffff1661ffff16815260200190815260200160002060030160008461ffff1661ffff168152602001908152602001600020600160028110151561197457fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff16145b15611a1d57600360008461ffff1661ffff16815260200190815260200160002060020180548060010182816119e69190613e16565b91600052602060002090601091828204019190066002025b84909190916101000a81548161ffff021916908361ffff160217905550505b80600360008561ffff1661ffff16815260200190815260200160002060030160008461ffff1661ffff1681526020019081526020016000206000600281101515611a6357fe5b600291828204019190066010025b8282829054906101000a90046fffffffffffffffffffffffffffffffff160192506101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff1602179055508261ffff168261ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167ff3eb50aadbf0d7c57ec5f56ac9bc98188c5eaf05702012ebfe3698cf182ccb4b846fffffffffffffffffffffffffffffffff1642604051808381526020018281526020019250505060405180910390a45b611c1a565b3373ffffffffffffffffffffffffffffffffffffffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f08a520c83f3f94e52d4d4b14319f76c4924f0b58aa571d1d8956acc5849651ea426040518082815260200191505060405180910390a35b505050565b600060048054905090505b90565b611c35613d8d565b6002805480602002602001604051908101604052809291908181526020018280548015611ca957602002820191906000526020600020906000905b82829054906101000a900461ffff1661ffff1681526020019060020190602082600101049283019260010382029150808411611c705790505b505050505090505b90565b600060026003811115611cc357fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff166003811115611d4757fe5b1480611de1575060036003811115611d5b57fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff166003811115611ddf57fe5b145b156120275760036000600660029054906101000a900461ffff1661ffff1661ffff1681526020019081526020016000209050838160000160006101000a8154816fffffffffffffffffffffffffffffffff021916908370010000000000000000000000000000000090040217905550828160000160106101000a8154816fffffffffffffffffffffffffffffffff021916908370010000000000000000000000000000000090040217905550818160010160006101000a8154816fffffffffffffffffffffffffffffffff02191690837001000000000000000000000000000000009004021790555060018160040160006101000a81548160ff02191690831515021790555060048054806001018281611efb9190613e16565b91600052602060002090601091828204019190066002025b600660029054906101000a900461ffff16909190916101000a81548161ffff021916908361ffff16021790555050600660029054906101000a900461ffff1661ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f1f6540b99f70a62641d39a080ec69b8a1442f4a4019da09b6bb25ae3d7d7621c60014260405180831515151581526020018281526020019250505060405180910390a36006600281819054906101000a900461ffff168092919060010191906101000a81548161ffff021916908361ffff160217905550505b6120c8565b3373ffffffffffffffffffffffffffffffffffffffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f08a520c83f3f94e52d4d4b14319f76c4924f0b58aa571d1d8956acc5849651ea426040518082815260200191505060405180910390a35b50505050565b6120d6613e50565b600360008461ffff1661ffff16815260200190815260200160002060040160009054906101000a900460ff1615806121375750600160008361ffff1661ffff16815260200190815260200160002060010160159054906101000a900460ff16155b1561214157610000565b600360008461ffff1661ffff16815260200190815260200160002060030160008361ffff1661ffff1681526020019081526020016000206002806020026040519081016040528092919082600280156121f3576020028201916000905b82829054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020019060100190602082600f0104928301926001038202915080841161219e5790505b505050505090505b92915050565b600060006000600060006000600060006002600381111561221e57fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff1660038111156122a257fe5b148061233c5750600360038111156122b657fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff16600381111561233a57fe5b145b1561344e576000896fffffffffffffffffffffffffffffffff16148061238b5750600360008b61ffff1661ffff16815260200190815260200160002060040160009054906101000a900460ff16155b806123b757506000600360008c61ffff1661ffff16815260200190815260200160002060020180549050145b156123c157610000565b60009750600096506000955060009450600094505b600360008b61ffff1661ffff168152602001908152602001600020600201805490508510156124ce57600360008b61ffff1661ffff1681526020019081526020016000206003016000600360008d61ffff1661ffff1681526020019081526020016000206002018781548110151561244a57fe5b90600052602060002090601091828204019190066002025b9054906101000a900461ffff1661ffff1661ffff168152602001908152602001600020600060028110151561249357fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff16880197505b84806001019550506123d6565b600094506000886fffffffffffffffffffffffffffffffff161115612ad457600094505b600360008b61ffff1661ffff16815260200190815260200160002060020180549050851015612ad357600360008b61ffff1661ffff1681526020019081526020016000206002018581548110151561254657fe5b90600052602060002090601091828204019190066002025b9054906101000a900461ffff169350600360008b61ffff1661ffff16815260200190815260200160002060030160008561ffff1661ffff16815260200190815260200160002060006002811015156125b257fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff169250600360008b61ffff1661ffff16815260200190815260200160002060030160008561ffff1661ffff168152602001908152602001600020600160028110151561262257fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff169150876fffffffffffffffffffffffffffffffff168984026fffffffffffffffffffffffffffffffff1681151561267e57fe5b049050826fffffffffffffffffffffffffffffffff168184036fffffffffffffffffffffffffffffffff161115612831578961ffff168461ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167ff3eb50aadbf0d7c57ec5f56ac9bc98188c5eaf05702012ebfe3698cf182ccb4b866fffffffffffffffffffffffffffffffff1660000342604051808381526020018281526020019250505060405180910390a48961ffff168461ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f190acdb2d73a06a0bfaba310bd3d6a1828c500aeab3cbc74168a53e44565c9e0864260405180836fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a482860195508282019150600092506129b0565b8961ffff168461ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167ff3eb50aadbf0d7c57ec5f56ac9bc98188c5eaf05702012ebfe3698cf182ccb4b846fffffffffffffffffffffffffffffffff1660000342604051808381526020018281526020019250505060405180910390a48961ffff168461ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f190acdb2d73a06a0bfaba310bd3d6a1828c500aeab3cbc74168a53e44565c9e0844260405180836fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a48083039250808201915080860195505b82600360008c61ffff1661ffff16815260200190815260200160002060030160008661ffff1661ffff16815260200190815260200160002060006002811015156129f657fe5b600291828204019190066010025b6101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff16021790555081600360008c61ffff1661ffff16815260200190815260200160002060030160008661ffff1661ffff1681526020019081526020016000206001600281101515612a7e57fe5b600291828204019190066010025b6101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff16021790555081870196505b84806001019550506124f2565b5b886fffffffffffffffffffffffffffffffff16866fffffffffffffffffffffffffffffffff161015612da7576000876fffffffffffffffffffffffffffffffff161115612da557600094505b600360008b61ffff1661ffff16815260200190815260200160002060020180549050851015612da057600360008b61ffff1661ffff16815260200190815260200160002060020185815481101515612b7457fe5b90600052602060002090601091828204019190066002025b9054906101000a900461ffff169350600360008b61ffff1661ffff16815260200190815260200160002060030160008561ffff1661ffff1681526020019081526020016000206001600281101515612be057fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff169150866fffffffffffffffffffffffffffffffff16868a0383026fffffffffffffffffffffffffffffffff16811515612c3e57fe5b0490508082019150808601955081600360008c61ffff1661ffff16815260200190815260200160002060030160008661ffff1661ffff1681526020019081526020016000206001600281101515612c9157fe5b600291828204019190066010025b6101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff1602179055508961ffff168461ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f190acdb2d73a06a0bfaba310bd3d6a1828c500aeab3cbc74168a53e44565c9e0844260405180836fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a45b8480600101955050612b20565b612da6565b5b5b886fffffffffffffffffffffffffffffffff16866fffffffffffffffffffffffffffffffff16101561335d57600360008b61ffff1661ffff1681526020019081526020016000206002016001600360008d61ffff1661ffff1681526020019081526020016000206002018054905003815481101515612e2257fe5b90600052602060002090601091828204019190066002025b9054906101000a900461ffff1693508589036fffffffffffffffffffffffffffffffff16600360008c61ffff1661ffff16815260200190815260200160002060030160008661ffff1661ffff1681526020019081526020016000206000600281101515612ea357fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff16111561304657858903600360008c61ffff1661ffff16815260200190815260200160002060030160008661ffff1661ffff1681526020019081526020016000206000600281101515612f2c57fe5b600291828204019190066010025b8282829054906101000a90046fffffffffffffffffffffffffffffffff160392506101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff1602179055508961ffff168461ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167ff3eb50aadbf0d7c57ec5f56ac9bc98188c5eaf05702012ebfe3698cf182ccb4b898d036fffffffffffffffffffffffffffffffff1660000342604051808381526020018281526020019250505060405180910390a46131ed565b8961ffff168461ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167ff3eb50aadbf0d7c57ec5f56ac9bc98188c5eaf05702012ebfe3698cf182ccb4b600360008f61ffff1661ffff16815260200190815260200160002060030160008961ffff1661ffff168152602001908152602001600020600060028110151561310857fe5b600291828204019190066010025b9054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1660000342604051808381526020018281526020019250505060405180910390a46000600360008c61ffff1661ffff16815260200190815260200160002060030160008661ffff1661ffff16815260200190815260200160002060006002811015156131aa57fe5b600291828204019190066010025b6101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff1602179055505b858903600360008c61ffff1661ffff16815260200190815260200160002060030160008661ffff1661ffff168152602001908152602001600020600160028110151561323557fe5b600291828204019190066010025b8282829054906101000a90046fffffffffffffffffffffffffffffffff160192506101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff1602179055508961ffff168461ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f190acdb2d73a06a0bfaba310bd3d6a1828c500aeab3cbc74168a53e44565c9e0898d034260405180836fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a48895505b886fffffffffffffffffffffffffffffffff16866fffffffffffffffffffffffffffffffff16111561338e57610000565b8961ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f56b23e5cb3910a046f9a66c3017ae49b4def7ebae1fb08b4adf446b4fd4c47f1884260405180836fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a35b6134ef565b3373ffffffffffffffffffffffffffffffffffffffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f08a520c83f3f94e52d4d4b14319f76c4924f0b58aa571d1d8956acc5849651ea426040518082815260200191505060405180910390a35b50505050505050505050565b6002600381111561350857fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff16600381111561358c57fe5b14806136265750600360038111156135a057fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff16600381111561362457fe5b145b1561380857600360008561ffff1661ffff16815260200190815260200160002060040160009054906101000a900460ff16151561366257610000565b82600360008661ffff1661ffff16815260200190815260200160002060000160006101000a8154816fffffffffffffffffffffffffffffffff02191690837001000000000000000000000000000000009004021790555081600360008661ffff1661ffff16815260200190815260200160002060000160106101000a8154816fffffffffffffffffffffffffffffffff02191690837001000000000000000000000000000000009004021790555080600360008661ffff1661ffff16815260200190815260200160002060010160006101000a8154816fffffffffffffffffffffffffffffffff0219169083700100000000000000000000000000000000900402179055508361ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f1f6540b99f70a62641d39a080ec69b8a1442f4a4019da09b6bb25ae3d7d7621c60004260405180831515151581526020018281526020019250505060405180910390a35b6138a9565b3373ffffffffffffffffffffffffffffffffffffffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f08a520c83f3f94e52d4d4b14319f76c4924f0b58aa571d1d8956acc5849651ea426040518082815260200191505060405180910390a35b50505050565b600260038111156138bc57fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff16600381111561394057fe5b14806139da57506003600381111561395457fe5b60016000600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff1661ffff16815260200190815260200160002060010160149054906101000a900460ff1660038111156139d857fe5b145b15613cd35760008273ffffffffffffffffffffffffffffffffffffffff161415613a0357610000565b608060405190810160405280846000191681526020018373ffffffffffffffffffffffffffffffffffffffff16815260200182613a41576001613a44565b60025b6003811115613a4f57fe5b81526020016001151581525060016000600660009054906101000a900461ffff1661ffff1661ffff1681526020019081526020016000206000820151816000019060001916905560208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060408201518160010160146101000a81548160ff02191690836003811115613b0157fe5b021790555060608201518160010160156101000a81548160ff021916908315150217905550905050600660009054906101000a900461ffff16600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548161ffff021916908361ffff16021790555060028054806001018281613ba79190613e16565b91600052602060002090601091828204019190066002025b600660009054906101000a900461ffff16909190916101000a81548161ffff021916908361ffff16021790555050600660009054906101000a900461ffff1661ffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f7107c2ae9754688147920c7dbf25c81ed808624042d38439123c6da5fe34beb460014260405180831515151581526020018281526020019250505060405180910390a36006600081819054906101000a900461ffff168092919060010191906101000a81548161ffff021916908361ffff160217905550505b613d74565b3373ffffffffffffffffffffffffffffffffffffffff16600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900461ffff1661ffff167f08a520c83f3f94e52d4d4b14319f76c4924f0b58aa571d1d8956acc5849651ea426040518082815260200191505060405180910390a35b505050565b602060405190810160405280600081525090565b602060405190810160405280600081525090565b6040604051908101604052806002905b60006fffffffffffffffffffffffffffffffff16815260200190600190039081613db15790505090565b6060604051908101604052806003905b60006fffffffffffffffffffffffffffffffff1916815260200190600190039081613deb5790505090565b815481835581811511613e4b57600f016010900481600f01601090048360005260206000209182019101613e4a9190613e8a565b5b505050565b6040604051908101604052806002905b60006fffffffffffffffffffffffffffffffff16815260200190600190039081613e605790505090565b613eac91905b80821115613ea8576000816000905550600101613e90565b5090565b905600a165627a7a723058202844fc839f0fd4c86b0875da210e424d970c1da31535d3ac810d23d97835bda80029';

		this.contractGas = '4700000';

		this.init();
		this.self = this;
	}

	init(){
		var self = this;
		window.onload = function() {
			while(!web3);
			web3.eth.getAccounts(function(err, accs) {
				if (err != null) {
				alert("There was an error fetching your accounts.");
				return;
				}

				if (accs.length == 0) {
				alert("Couldn't get any accounts! Make sure your Ethereum client is configured correctly.");
				return;
			}
			
				self.accounts = accs;
				self.account = self.accounts[0];
				
			});
		}
	}

	deployNewContract() {
		while(!web3);

		var obitcoinContract = web3.eth.contract(this.contractAbi);
		this.Obitcoin = obitcoinContract.new(
		{
			from: web3.eth.accounts[0], 
			data: this.contractCompiled, 
			gas: this.contractGas
		}, function (e, contract){
			console.log(e, contract);
			if (typeof contract.address !== 'undefined') {
				console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
				
				//this.startListeningForEvents();
			}
		})
	}

	connectToContract(address, callback) {
		while(!web3);

		var obitcoinContract = web3.eth.contract(this.contractAbi);
		
		this.Obitcoin = obitcoinContract.at(address);
		
		var self = this;

		this.Obitcoin.getContractAddress.call({from: this.account}, function(error, result){
			if(!error)
				if(result==address){
					console.log("Connection successful");
					callback();
					//self.startListeningForEvents();
				} else {
					console.log("Invalid address!");
				}
			else
				console.error(error);
		});
	}

	addMember(name, address, isAdmin, callback){
		console.log("Address is "+address);
		this.Obitcoin.addMember(name, address, isAdmin, {from: this.account}, function(error, result){
			if(!error){
				callback(result);
			}
			else
				console.error(error);
		});
	}

	setAdmin(member, admin) {
		this.Obitcoin.setAdmin(member, admin, {from: this.account}, function(error, result){
			if(!error)
				console.log(result);
			else
				console.error(error);
		});
	}

	createDebtPool(name, legalContract, financialReports, callback) {
		this.Obitcoin.createDebtPool(name, legalContract, financialReports, {from: this.account}, function(error, result){
			if(!error)
				callback(result);
			else
				console.error(error);
		});
	}

	getPools(callback){
		this.Obitcoin.getPools.call({from: this.account}, function(error, result){
			if(!error){
				var data = [];
				result.forEach(res => data.push(res.valueOf()));
				callback(data);
			}
			else
				console.error(error);
		});
	}

	getPoolData(pool, callback){
		var self = this;
		this.Obitcoin.getPoolData.call(pool, {from: this.account}, function(error, result){
			if(!error){
				var data = [];
				result.forEach(item => data.push(self.hex2a(item)));
				callback(data);
			}
			else
				console.error(error);
		});
	}

	getPoolParticipants(pool, callback) {
		this.Obitcoin.getPoolParticipants.call(pool, {from: this.account}, function(error, result){
			if(!error){
				var data = [];
				result.forEach(res => data.push(res.valueOf()));
				callback(data);
			}
			else
				console.error(error);
		});
	}

	getMembers(callback){
		this.Obitcoin.getMembers.call({from: this.account}, function(error, result){
			if(!error){
				var data = [];
				result.forEach(res => data.push(res.valueOf()));
				callback(data);
			}
			else
				console.error(error);
		});
	}

	getMemberBalance(pool, member, callback){
		this.Obitcoin.getMemberBalance.call(pool, member, {from: this.account}, function(error, result){
			if(!error){
				var data = [];
				result.forEach(res => data.push(res.valueOf()));
				callback(data, member);
			}
			else
				console.error(error);
		});
	}

	getMemberName(member, callback){
		var self = this;
		this.Obitcoin.getMemberName.call(member, {from: this.account}, function(error, result){
			if(!error){
				callback(self.hex2a(result));
			}
			else
				console.error(error);
		});
	}
		
	getMemberAddress(member, callback){
		this.Obitcoin.getMemberAddress.call(member, {from: this.account}, function(error, result){
			if(!error){
				callback(result);
			}
			else
				console.error(error);
		});
	}

	getMemberPermLevel(member, callback){
		this.Obitcoin.getMemberPermLevel.call(member, {from: this.account}, function(error, result){
			if(!error)
				callback(result.valueOf());
			else
				console.error(error);
		});
	}

	getMemberDetails(member, callback){
		var self = this;

		this.Obitcoin.getMemberDetails.call(member, {from: this.account}, function(error, result){
			if(!error){
				var data = [3];
				data[0] = self.hex2a(result[0]);
				data[1] = result[1];
				data[2] = result[2].valueOf();

				callback(data);
			}
			else
				console.error(error);
		});
	}

	updateMember(member, name, address, isAdmin, callback){
		this.Obitcoin.updateMember(member, name, address, isAdmin, {from: this.account}, function(error, result){
			if(!error){
				console.log(result);
				callback(result);
			}
			else
				console.error(error);
		});
	}

	updatePool(pool, name, legalContract, financialReports, callback){
		this.Obitcoin.updateDebtPool(pool, name, legalContract, financialReports, {from: this.account}, function(error, result){
			if(!error){
				console.log(result);
				callback(result);
			}
			else
				console.error(error);
		});
	}

	sendCoins(pool, member, amount){
		this.Obitcoin.sendCoins(pool, member, amount, {from: this.account}, function(error, result){
			if(!error)
				console.log(result)
			else
				console.error(error);
		});
	}

	buyCoins(pool, amount){
		this.Obitcoin.buyCoins(pool, amount, {from: this.account}, function(error, result){
			if(!error)
				console.log(result)
			else
				console.error(error);
		});
	}

	getWholeMembers(callback){
		var members = [];
		var self = this;
		this.getMembers(function(data){
			for(var i = 0; i<data.length; i++){
				self.getWholeMember(data[i], function(member){
					members.push(member);
					//console.log(member);

					if(members.length == data.length){
						callback(members);
					}
				});

			}
		});
	}

	getWholeMember(id, callback){
		var member = {};
		member.id = Number(id);

		this.getMemberDetails(id, function(result){
			member.name = result[0];
			member.address = result[1];
			member.permLevel = result[2];

			callback(member);
		});

		/*this.getMemberName(id, function(result){
			member.name = result;

			if(member.name != undefined && member.address != undefined && member.permissionLevel != undefined) callback(member);
		});
		this.getMemberAddress(id, function(result){
			member.address = result;

			if(member.name != undefined && member.address != undefined && member.permissionLevel != undefined) callback(member);
		});
		this.getMemberPermLevel(id, function(result){
			member.permissionLevel = Number(result);

			if(member.name != undefined && member.address != undefined && member.permissionLevel != undefined) callback(member);
		});*/
	}

	getWholePools(callback){
		var pools = [];
		var self = this;
		this.getPools(function(data){
			console.log(data);
			for(var i = 0; i<data.length; i++){
				self.getWholePool(data[i], function(pool){
					pools.push(pool);
					console.log(pool);

					if(pools.length == data.length){
						callback(pools);
					}
				});

			}
		});
	}

	getWholePool(id, callback){
		console.log("getting id "+id);
		var self = this;

		var pool = {};
		pool.id = Number(id);
		var stage1=false, stage2=false;

		pool.tokens = new Map();
		pool.slices = new Map();

		this.getPoolData(id, function(result){
			console.log(result);
			pool.name = result[0];
			pool.legalContract = result[1];
			pool.financialReports = result[2];

			stage1=true;

			if(stage1 && stage2) callback(pool);
		});

		this.getPoolParticipants(id, function(result){
			pool.members = [];
			result.forEach(item => pool.members.push(Number(item)));
			
			if(result.length==0 && stage1) callback(pool);

			for(var i=0; i<result.length; i++){
				self.getMemberBalance(id, result[i], function(data, member){
					pool.tokens[Number(member)] = Number(data[0]);
					pool.slices[Number(member)] = Number(data[1]);

					if(result[result.length-1]==member){
						stage2=true;

						if(stage1 && stage2) callback(pool);
					}
				});
			}
		});
	}

	startListeningForEvents(callback){
		var self = this;

		this.Obitcoin.getPublishingBlockNumber.call({from: this.account}, function(error, result){
			console.log(result);
			console.log(result.valueOf());

			var events = self.Obitcoin.allEvents({fromBlock: result.valueOf()});
			events.watch(function(err, event) {
				if (err) {
					console.log(err)
					return;
				}
				
				console.log(event);

				callback(event);
			});

		});

		/*var coinsTransferEvent = this.Obitcoin.CoinsTransfer({}, {fromBlock: 0});
		coinsTransferEvent.watch(function(err, result) {
			if (err) {
				console.log(err)
				return;
			}
			console.log("["+result.args.time.valueOf()+"] sent "+result.args.amount.valueOf()+" from "+result.args.from+" to "+result.args.to);
		});
		
		var coinsPurchaseEvent = this.Obitcoin.CoinsPurchase({}, {fromBlock: 0});
		coinsPurchaseEvent.watch(function(err, result) {
			if (err) {
				console.log(err)
				return;
			}
			console.log("["+result.args.time.valueOf()+"] bought "+result.args.amount.valueOf()+" from "+result.args.from+" to "+result.args.poolIndex+" debt pool");
		});
		
		var poolCreatedEvent = this.Obitcoin.PoolCreated({}, {fromBlock: 0});
		poolCreatedEvent.watch(function(err,result) {
			if(err) {
				console.log(err);
				return;
			}
			console.log("["+result.args.time.valueOf()+"] created pool with index "+result.args.index.valueOf());
		});
		
		var unauthorizedAccessEvent = this.Obitcoin.UnauthorizedAccess({}, {fromBlock: 0});
		unauthorizedAccessEvent.watch(function(err,result) {
			if(err) {
				console.log(err);
				return;
			}
			console.log("["+result.args.time.valueOf()+"] Warning! Unauthorized access from "+result.args.from);
		});
		
		var adminChangedEvent = this.Obitcoin.AdminChanged({}, {fromBlock: 0});
		adminChangedEvent.watch(function(err,result) {
			if(err) {
				console.log(err);
				return;
			}
			console.log("["+result.args.time.valueOf()+"]" + (result.args.added ? "Added" : "Removed") + " admin with address "+result.args.person);
		});*/
		
		
	}

	hex2a(hexx) {
		var hex = hexx.toString();//force conversion
		var str = '';
		var int;
		for (var i = 2; i < hex.length; i += 2){
			int = parseInt(hex.substr(i, 2), 16);
			if(int==0) continue;
			str += String.fromCharCode(int);
		}
		return str;
	}

}